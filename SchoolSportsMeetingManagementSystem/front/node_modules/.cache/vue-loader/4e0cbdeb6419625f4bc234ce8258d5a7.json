{"remainingRequest":"C:\\Users\\asus\\SchoolSportsMeetingManagementSystem\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\asus\\SchoolSportsMeetingManagementSystem\\front\\src\\views\\modules\\siachenganpai\\list.vue?vue&type=style&index=0&id=7606eaf2&scoped=true&lang=css","dependencies":[{"path":"C:\\Users\\asus\\SchoolSportsMeetingManagementSystem\\front\\src\\views\\modules\\siachenganpai\\list.vue","mtime":1753871376743},{"path":"C:\\Users\\asus\\SchoolSportsMeetingManagementSystem\\front\\node_modules\\css-loader\\dist\\cjs.js","mtime":1753355015846},{"path":"C:\\Users\\asus\\SchoolSportsMeetingManagementSystem\\front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1753355017484},{"path":"C:\\Users\\asus\\SchoolSportsMeetingManagementSystem\\front\\node_modules\\postcss-loader\\src\\index.js","mtime":1753355016477},{"path":"C:\\Users\\asus\\SchoolSportsMeetingManagementSystem\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753355015215},{"path":"C:\\Users\\asus\\SchoolSportsMeetingManagementSystem\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":1753355017011}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5tYWluLWNvbnRlbnQgewogICAgcGFkZGluZzogMTBweDsKfQouZm9ybS1jb250ZW50IHsKICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7CiAgICBwYWRkaW5nOiAxMHB4OwogICAgbWFyZ2luLWJvdHRvbTogMTBweDsKfQoudGFibGUtY29udGVudCB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmOwogICAgcGFkZGluZzogMTBweDsKfQoucGFnaW5hdGlvbi1jb250ZW50IHsKICAgIG1hcmdpbi10b3A6IDEwcHg7Cn0K"},{"version":3,"sources":["list.vue"],"names":[],"mappings":";AAm6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"list.vue","sourceRoot":"src/views/modules/siachenganpai","sourcesContent":["<template>\r\n    <div class=\"main-content\">\r\n\r\n        <!-- 条件查询 -->\r\n        <div v-if=\"showFlag\">\r\n            <el-form :inline=\"true\" :model=\"searchForm\" class=\"form-content\">\r\n                <el-row :gutter=\"20\" class=\"slt\" :style=\"{justifyContent:contents.searchBoxPosition=='1'?'flex-start':contents.searchBoxPosition=='2'?'center':'flex-end'}\">\r\n                                                 \r\n                     <el-form-item :label=\"contents.inputTitle == 1 ? '比赛状态' : ''\">\r\n                        <el-select v-model=\"searchForm.zhuangtaiTypes\" placeholder=\"请选择比赛状态\">\r\n                            <el-option label=\"=-请选择-=\" value=\"\"></el-option>\r\n                            <el-option\r\n                               v-for=\"(item,index) in zhuangtaiTypesSelectSearch\"\r\n                               v-bind:key=\"index\"\r\n                               :label=\"item.indexName\"\r\n                               :value=\"item.codeIndex\">\r\n                            </el-option>\r\n                        </el-select>\r\n                     </el-form-item>\r\n\r\n         \r\n                     <el-form-item :label=\"contents.inputTitle == 1 ? '比赛结果' : ''\">\r\n                        <el-select v-model=\"searchForm.siachenganpaiTypes\" placeholder=\"请选择比赛结果\">\r\n                            <el-option label=\"=-请选择-=\" value=\"\"></el-option>\r\n                            <el-option\r\n                               v-for=\"(item,index) in siachenganpaiTypesSelectSearch\"\r\n                               v-bind:key=\"index\"\r\n                               :label=\"item.indexName\"\r\n                               :value=\"item.codeIndex\">\r\n                            </el-option>\r\n                        </el-select>\r\n                     </el-form-item>\r\n\r\n                        \r\n                                         \r\n                    <el-form-item :label=\"contents.inputTitle == 1 ? '项目标题' : ''\">\r\n                        <el-input prefix-icon=\"el-icon-search\" v-model=\"searchForm.bisaixiangmuName\" placeholder=\"项目标题\" clearable></el-input>\r\n                    </el-form-item>\r\n                                                                                                     \r\n                    <el-form-item :label=\"contents.inputTitle == 1 ? '项目类型' : ''\">\r\n                        <el-select v-model=\"searchForm.bisaixiangmuTypes\" placeholder=\"请选择项目类型\">\r\n                            <el-option label=\"=-请选择-=\" value=\"\"></el-option>\r\n                            <el-option\r\n                                    v-for=\"(item,index) in bisaixiangmuTypesSelectSearch\"\r\n                                    v-bind:key=\"index\"\r\n                                    :label=\"item.indexName\"\r\n                                    :value=\"item.codeIndex\">\r\n                            </el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                                                                                                                                             \r\n                    <el-form-item :label=\"contents.inputTitle == 1 ? '用户名称' : ''\">\r\n                        <el-input prefix-icon=\"el-icon-search\" v-model=\"searchForm.yonghuName\" placeholder=\"用户名称\" clearable></el-input>\r\n                    </el-form-item>\r\n                                                                                                                                            \r\n\r\n                    <el-form-item>\r\n                        <el-button type=\"success\" @click=\"search()\">查询<i class=\"el-icon-search el-icon--right\"/></el-button>\r\n                    </el-form-item>\r\n                </el-row>\r\n                <el-row class=\"ad\" :style=\"{justifyContent:contents.btnAdAllBoxPosition=='1'?'flex-start':contents.btnAdAllBoxPosition=='2'?'center':'flex-end'}\">\r\n                    <el-form-item>\r\n                        <el-button\r\n                                v-if=\"isAuth('siachenganpai','新增')\"\r\n                                type=\"success\"\r\n                                icon=\"el-icon-plus\"\r\n                                @click=\"addOrUpdateHandler()\"\r\n                        >新增</el-button>\r\n                        &nbsp;\r\n                        <el-button\r\n                                v-if=\"isAuth('siachenganpai','删除')\"\r\n                                :disabled=\"dataListSelections.length <= 0\"\r\n                                type=\"danger\"\r\n                                icon=\"el-icon-delete\"\r\n                                @click=\"deleteHandler()\"\r\n                        >删除</el-button>\r\n                        &nbsp;\r\n                        <el-button\r\n                                v-if=\"isAuth('siachenganpai','报表')\"\r\n                                type=\"success\"\r\n                                icon=\"el-icon-pie-chart\"\r\n                                @click=\"chartDialog()\"\r\n                        >报表</el-button>\r\n                        &nbsp;\r\n                        <a style=\"text-decoration:none\" class=\"el-button el-button--success\"\r\n                           v-if=\"isAuth('siachenganpai','导入导出')\"\r\n                           icon=\"el-icon-download\"\r\n                           href=\"http://localhost:8080/xiaoyunhuiguanli/upload/siachenganpaiMuBan.xls\"\r\n                        >批量导入赛程安排数据模板</a>\r\n                        &nbsp;\r\n                        <el-upload\r\n                                v-if=\"isAuth('siachenganpai','导入导出')\"\r\n                                style=\"display: inline-block\"\r\n                                :action=\"getActionUrl\"\r\n                                :on-success=\"siachenganpaiUploadSuccess\"\r\n                                :on-error=\"siachenganpaiUploadError\"\r\n                                :show-file-list = false>\r\n                            <el-button\r\n                                    v-if=\"isAuth('siachenganpai','导入导出')\"\r\n                                    type=\"success\"\r\n                                    icon=\"el-icon-upload2\"\r\n                            >批量导入赛程安排数据</el-button>\r\n                        </el-upload>\r\n                        &nbsp;\r\n                        <!-- 导出excel -->\r\n                        <download-excel v-if=\"isAuth('siachenganpai','导入导出')\" style=\"display: inline-block\" class = \"export-excel-wrapper\" :data = \"dataList\" :fields = \"json_fields\" name = \"siachenganpai.xls\">\r\n                            <el-button\r\n                                    type=\"success\"\r\n                                    icon=\"el-icon-download\"\r\n                            >导出</el-button>\r\n                        </download-excel>\r\n                        &nbsp;\r\n                    </el-form-item>\r\n                </el-row>\r\n            </el-form>\r\n            <div class=\"table-content\">\r\n                <el-table class=\"tables\" :size=\"contents.tableSize\" :show-header=\"contents.tableShowHeader\"\r\n                          :header-row-style=\"headerRowStyle\" :header-cell-style=\"headerCellStyle\"\r\n                          :border=\"contents.tableBorder\"\r\n                          :fit=\"contents.tableFit\"\r\n                          :stripe=\"contents.tableStripe\"\r\n                          :row-style=\"rowStyle\"\r\n                          :cell-style=\"cellStyle\"\r\n                          :style=\"{width: '100%',fontSize:contents.tableContentFontSize,color:contents.tableContentFontColor}\"\r\n                          v-if=\"isAuth('siachenganpai','查看')\"\r\n                          :data=\"dataList\"\r\n                          v-loading=\"dataListLoading\"\r\n                          @selection-change=\"selectionChangeHandler\">\r\n                    <el-table-column  v-if=\"contents.tableSelection\"\r\n                                      type=\"selection\"\r\n                                      header-align=\"center\"\r\n                                      align=\"center\"\r\n                                      width=\"50\">\r\n                    </el-table-column>\r\n                    <el-table-column label=\"索引\" v-if=\"contents.tableIndex\" type=\"index\" width=\"50\" />\r\n                    <el-table-column  :sortable=\"contents.tableSortable\" :align=\"contents.tableAlign\"\r\n                                      prop=\"bisaixiangmuName\"\r\n                                      header-align=\"center\"\r\n                                      label=\"项目标题\">\r\n                        <template slot-scope=\"scope\">\r\n                            {{scope.row.bisaixiangmuName}}\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column :sortable=\"contents.tableSortable\" :align=\"contents.tableAlign\" prop=\"bisaixiangmuPhoto\"\r\n                               header-align=\"center\"\r\n                               width=\"200\"\r\n                               label=\"项目封面\">\r\n                        <template slot-scope=\"scope\">\r\n                            <div v-if=\"scope.row.bisaixiangmuPhoto\">\r\n                                <img :src=\"$base.url+scope.row.bisaixiangmuPhoto\" width=\"100\" height=\"100\">\r\n                            </div>\r\n                            <div v-else>无图片</div>\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column  :sortable=\"contents.tableSortable\" :align=\"contents.tableAlign\"\r\n                                      prop=\"bisaixiangmuPhone\"\r\n                                      header-align=\"center\"\r\n                                      label=\"联系方式\">\r\n                        <template slot-scope=\"scope\">\r\n                            {{scope.row.bisaixiangmuPhone}}\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column  :sortable=\"contents.tableSortable\" :align=\"contents.tableAlign\"\r\n                                      prop=\"bisaixiangmuTypes\"\r\n                                      header-align=\"center\"\r\n                                      label=\"项目类型\">\r\n                        <template slot-scope=\"scope\">\r\n                            {{scope.row.bisaixiangmuValue}}\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column  :sortable=\"contents.tableSortable\" :align=\"contents.tableAlign\"\r\n                                      prop=\"yonghuName\"\r\n                                      header-align=\"center\"\r\n                                      label=\"用户名称\">\r\n                        <template slot-scope=\"scope\">\r\n                            {{scope.row.yonghuName}}\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column  :sortable=\"contents.tableSortable\" :align=\"contents.tableAlign\"\r\n                                      prop=\"yonghuPhone\"\r\n                                      header-align=\"center\"\r\n                                      label=\"用户手机号\">\r\n                        <template slot-scope=\"scope\">\r\n                            {{scope.row.yonghuPhone}}\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column :sortable=\"contents.tableSortable\" :align=\"contents.tableAlign\" prop=\"yonghuPhoto\"\r\n                               header-align=\"center\"\r\n                               width=\"200\"\r\n                               label=\"用户头像\">\r\n                        <template slot-scope=\"scope\">\r\n                            <div v-if=\"scope.row.yonghuPhoto\">\r\n                                <img :src=\"$base.url+scope.row.yonghuPhoto\" width=\"100\" height=\"100\">\r\n                            </div>\r\n                            <div v-else>无图片</div>\r\n                        </template>\r\n                    </el-table-column>\r\n\r\n                    <el-table-column  :sortable=\"contents.tableSortable\" :align=\"contents.tableAlign\"\r\n                                   prop=\"siachenganpaiFuzhenr\"\r\n                                   header-align=\"center\"\r\n                                   label=\"比赛时间\">\r\n                        <template slot-scope=\"scope\">\r\n                            {{scope.row.siachenganpaiFuzhenr}}\r\n                        </template>\r\n                    </el-table-column>\r\n\r\n                    <el-table-column  :sortable=\"contents.tableSortable\" :align=\"contents.tableAlign\"\r\n                                   prop=\"siachenganpaiPhone\"\r\n                                   header-align=\"center\"\r\n                                   label=\"比赛场地\">\r\n                        <template slot-scope=\"scope\">\r\n                            {{scope.row.siachenganpaiPhone}}\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column  :sortable=\"contents.tableSortable\" :align=\"contents.tableAlign\"\r\n                                      prop=\"zhuangtaiTypes\"\r\n                                      header-align=\"center\"\r\n                                      label=\"比赛状态\">\r\n                        <template slot-scope=\"scope\">\r\n                            {{scope.row.zhuangtaiValue}}\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column  :sortable=\"contents.tableSortable\" :align=\"contents.tableAlign\"\r\n                                      prop=\"siachenganpaiTypes\"\r\n                                      header-align=\"center\"\r\n                                      label=\"比赛结果\">\r\n                        <template slot-scope=\"scope\">\r\n                            {{scope.row.siachenganpaiValue}}\r\n                        </template>\r\n                    </el-table-column>\r\n\r\n                    <el-table-column  :sortable=\"contents.tableSortable\" :align=\"contents.tableAlign\"\r\n                                   prop=\"insertTime\"\r\n                                   header-align=\"center\"\r\n                                   label=\"发布日期\">\r\n                        <template slot-scope=\"scope\">\r\n                            {{scope.row.insertTime}}\r\n                        </template>\r\n                    </el-table-column>\r\n\r\n                    <el-table-column width=\"300\" :align=\"contents.tableAlign\"\r\n                                     header-align=\"center\"\r\n                                     label=\"操作\">\r\n                        <template slot-scope=\"scope\">\r\n                            <el-button v-if=\"sessionTable=='false'\" type=\"primary\" size=\"mini\" @click=\"wuyong(scope.row.id)\">无用按钮</el-button>\r\n                            <el-button v-if=\"sessionTable=='false'\" type=\"success\" icon=\"el-icon-printer\" size=\"mini\" @click=\"dayinOpen(scope.row)\">打印</el-button>\r\n                            <el-button v-if=\"isAuth('siachenganpai','查看')\" type=\"success\" icon=\"el-icon-tickets\" size=\"mini\" @click=\"addOrUpdateHandler(scope.row.id,'info')\">详情</el-button>\r\n                            <el-button v-if=\"isAuth('siachenganpai','修改') && scope.row.zhuangtaiTypes == 2\" type=\"primary\" icon=\"el-icon-edit\" size=\"mini\" @click=\"addOrUpdateHandler(scope.row.id)\">{{scope.row.zhuangtaiTypes == null?\"添加成绩信息\":\"修改成绩信息\"}}</el-button>\r\n                            <el-button v-if=\"isAuth('siachenganpai','删除')\" type=\"danger\" icon=\"el-icon-delete\" size=\"mini\" @click=\"deleteHandler(scope.row.id)\">删除</el-button>\r\n                            <el-button v-if=\"isAuth('siachenganpai','修改') && scope.row.zhuangtaiTypes == 1\" type=\"primary\" icon=\"el-icon-edit\" size=\"mini\" @click=\"jieshubisai(scope.row.id)\">比赛结束</el-button>\r\n\r\n                        </template>\r\n                    </el-table-column>\r\n                </el-table>\r\n                <el-pagination\r\n                        clsss=\"pages\"\r\n                        :layout=\"layouts\"\r\n                        @size-change=\"sizeChangeHandle\"\r\n                        @current-change=\"currentChangeHandle\"\r\n                        :current-page=\"pageIndex\"\r\n                        :page-sizes=\"[10, 20, 50, 100]\"\r\n                        :page-size=\"Number(contents.pageEachNum)\"\r\n                        :total=\"totalPage\"\r\n                        :small=\"contents.pageStyle\"\r\n                        class=\"pagination-content\"\r\n                        :background=\"contents.pageBtnBG\"\r\n                        :style=\"{textAlign:contents.pagePosition==1?'left':contents.pagePosition==2?'center':'right'}\"\r\n                ></el-pagination>\r\n            </div>\r\n        </div>\r\n        <!-- 添加/修改页面  将父组件的search方法传递给子组件-->\r\n        <add-or-update v-if=\"addOrUpdateFlag\" :parent=\"this\" ref=\"addOrUpdate\"></add-or-update>\r\n\r\n\r\n        <el-dialog title=\"打印\" :visible.sync=\"printVisiable\" width=\"500px\">\r\n            <el-form ref=\"printContent\" :model=\"printFrom\" label-width=\"auto\">\r\n                <el-form-item label=\"发件人\">\r\n                    <div  style=\"display: flex\">\r\n                        <el-input v-model=\"printFrom.kuaidiFajianName\" disabled></el-input>\r\n                        :\r\n                        <el-input v-model=\"printFrom.kuaidiFajianShoujihao\" disabled></el-input>\r\n                    </div>\r\n                </el-form-item>\r\n                <el-form-item label=\"发件人地址\">\r\n                    <el-input v-model=\"printFrom.kuaidiFajianAddress\" disabled></el-input>\r\n                </el-form-item>\r\n            </el-form>\r\n            <span slot=\"footer\" class=\"dialog-footer\">\r\n              <el-button @click=\"printContent()\" icon=\"el-icon-printer\" type=\"success\">打印</el-button>\r\n              <el-button @click=\"printVisiable = false\">关闭</el-button>\r\n            </span>\r\n        </el-dialog>\r\n\r\n        <el-dialog title=\"统计报表\" :visible.sync=\"chartVisiable\" width=\"80%\">\r\n            <el-date-picker v-model=\"echartsDate\" type=\"year\" placeholder=\"选择年\"> </el-date-picker>\r\n            <el-button @click=\"chartDialog()\">查询</el-button>\r\n                <div id=\"statistic\" style=\"width:100%;height:600px;\"></div>\r\n\r\n            <span slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t\t<el-button @click=\"chartVisiable = false\">关闭</el-button>\r\n\t\t\t</span>\r\n        </el-dialog>\r\n\r\n    </div>\r\n</template>\r\n<script>\r\n    import AddOrUpdate from \"./add-or-update\";\r\n    import styleJs from \"../../../utils/style.js\";\r\n    import utilsJs, {getYearFormat,getMonthFormat,getDateFormat,getDatetimeFormat} from \"../../../utils/utils.js\";\r\n\r\n    export default {\r\n        data() {\r\n            return {\r\n                // 打印相关\r\n                printFrom: {\r\n                    name1:\"\",\r\n                },\r\n                printVisiable: false,\r\n                \r\n                // 搜索表单\r\n                searchForm: {\r\n                    key: \"\"\r\n                },\r\n                \r\n                // 用户信息\r\n                sessionTable : \"\", // 登录账户所在表名\r\n                role : \"\",         // 用户角色\r\n                userId:\"\",         // 当前登录人ID\r\n                \r\n                // 下拉框数据\r\n                bisaixiangmuTypesSelectSearch : [],\r\n                zhuangtaiTypesSelectSearch : [],\r\n                siachenganpaiTypesSelectSearch : [],\r\n                \r\n                // 表单数据\r\n                form:{\r\n                    id : null,\r\n                    bisaixiangmuId : null,\r\n                    yonghuId : null,\r\n                    siachenganpaiFuzhenr : null,\r\n                    siachenganpaiPhone : null,\r\n                    zhuangtaiTypes : null,\r\n                    siachenganpaiTypes : null,\r\n                    siachenganpaiContent : null,\r\n                    insertTime : null,\r\n                    createTime : null,\r\n                },\r\n                \r\n                // 表格数据\r\n                dataList: [],\r\n                pageIndex: 1,\r\n                pageSize: 10,\r\n                totalPage: 0,\r\n                dataListLoading: false,\r\n                dataListSelections: [],\r\n                \r\n                // 视图控制\r\n                showFlag: true,\r\n                sfshVisiable: false,\r\n                shForm: {},\r\n                chartVisiable: false,\r\n                echartsDate: new Date(),\r\n                addOrUpdateFlag: false,\r\n                crossAddOrUpdateFlag: false, // 新增：避免未定义错误\r\n                \r\n                // 页面样式配置\r\n                contents: null,\r\n                layouts: '',\r\n                \r\n                // 导出配置\r\n                json_fields: {\r\n                    '项目标题': 'bisaixiangmuName',\r\n                    '项目封面': 'bisaixiangmuPhoto',\r\n                    '工作时间': 'bisaixiangmuShijian',\r\n                    '负责人': 'bisaixiangmuFuzhenr',\r\n                    '联系方式': 'bisaixiangmuPhone',\r\n                    '项目类型': 'bisaixiangmuTypes',\r\n                    '结束时间': 'jieshuTime',\r\n                    '用户名称': 'yonghuName',\r\n                    '用户手机号': 'yonghuPhone',\r\n                    '用户身份证号': 'yonghuIdNumber',\r\n                    '用户头像': 'yonghuPhoto',\r\n                    '用户邮箱': 'yonghuEmail',\r\n                    '比赛时间': \"siachenganpaiFuzhenr\",\r\n                    '比赛场地': \"siachenganpaiPhone\",\r\n                    '比赛状态': \"zhuangtaiValue\",\r\n                    '比赛结果': \"siachenganpaiValue\",\r\n                    '发布日期': \"insertTime\",\r\n                },\r\n                \r\n                // 用户权限列表\r\n                userPermissions: [],\r\n            };\r\n        },\r\n        created() {\r\n            this.contents = styleJs.listStyle();\r\n            this.init();\r\n            this.getDataList();\r\n            this.contentStyleChange();\r\n            this.loadUserPermissions(); // 加载用户权限\r\n        },\r\n        mounted() {\r\n            // 获取当前登录用户的信息\r\n            this.sessionTable = this.$storage.get(\"sessionTable\") || \"\";\r\n            this.role = this.$storage.get(\"role\") || \"\";\r\n            this.userId = this.$storage.get(\"userId\") || \"\";\r\n            console.log(\"当前用户角色:\", this.role);\r\n        },\r\n        filters: {\r\n            htmlfilter: function (val) {\r\n                return val.replace(/<[^>]*>/g).replace(/undefined/g,'');\r\n            }\r\n        },\r\n        components: {\r\n            AddOrUpdate,\r\n        },\r\n        computed: {\r\n            getActionUrl: function() {\r\n                return `/`+this.$base.name+`/file/upload`;\r\n            }\r\n        },\r\n        methods: {\r\n            // 权限检查方法\r\n            isAuth(module, action) {\r\n                // 超级管理员默认拥有所有权限\r\n                if (this.role === 'admin') {\r\n                    console.log(`权限检查: ${module}:${action} -> 管理员直接通过`);\r\n                    return true;\r\n                }\r\n                \r\n                // 构建权限字符串\r\n                const permissionStr = `${module}:${action}`;\r\n                \r\n                // 开发环境：若权限列表为空，默认允许访问（便于调试）\r\n                if (process.env.NODE_ENV === 'development' && this.userPermissions.length === 0) {\r\n                    console.warn(`开发环境：权限列表为空，自动授予${permissionStr}权限`);\r\n                    return true;\r\n                }\r\n                \r\n                // 检查权限是否存在\r\n                const hasPermission = this.userPermissions.includes(permissionStr);\r\n                console.log(`权限检查: ${permissionStr} -> ${hasPermission ? '允许' : '拒绝'}`);\r\n                return hasPermission;\r\n            },\r\n            \r\n            // 加载用户权限\r\n            loadUserPermissions() {\r\n                // 优先从本地存储获取权限\r\n                let storedPermissions = this.$storage.get(\"userPermissions\");\r\n                \r\n                // 若本地存储中没有权限，使用默认测试权限（开发环境）\r\n                if (!storedPermissions || storedPermissions.length === 0) {\r\n                    console.warn(\"未找到用户权限，使用默认测试权限（开发环境）\");\r\n                    storedPermissions = [\r\n                        \"siachenganpai:查看\",\r\n                        \"siachenganpai:新增\",\r\n                        \"siachenganpai:删除\",\r\n                        \"siachenganpai:报表\",\r\n                        \"siachenganpai:修改\",\r\n                        \"siachenganpai:导入导出\"\r\n                    ];\r\n                    \r\n                    // 保存到本地存储，避免刷新后丢失\r\n                    this.$storage.set(\"userPermissions\", storedPermissions);\r\n                }\r\n                \r\n                this.userPermissions = storedPermissions;\r\n                console.log(\"当前用户权限:\", this.userPermissions);\r\n            },\r\n            \r\n            // 图表相关方法\r\n            chartDialog() {\r\n                let _this = this;\r\n                let params = {\r\n                    dateFormat :\"%Y\", \r\n                    riqi :getYearFormat(_this.echartsDate),\r\n                    thisTable : {\r\n                        tableName :'siachenganpai',\r\n                        date : 'insert_time',\r\n                        types : 'siachenganpai_types',\r\n                    }\r\n                }\r\n                _this.chartVisiable = true;\r\n                _this.$nextTick(() => {\r\n                    var statistic = this.$echarts.init(document.getElementById(\"statistic\"), 'macarons');\r\n                    this.$http({\r\n                        url: \"barCount\",\r\n                        method: \"get\",\r\n                        params: params\r\n                    }).then(({data}) => {\r\n                        if(data && data.code === 0){\r\n                            let yAxisName = \"数值\";\r\n                            let xAxisName = \"月份\";\r\n                            let series = [];\r\n                            data.data.yAxis.forEach(function (item,index) {\r\n                                let tempMap = {};\r\n                                tempMap.name=data.data.legend[index];\r\n                                tempMap.type='bar';\r\n                                tempMap.data=item;\r\n                                series.push(tempMap);\r\n                            })\r\n\r\n                            var option = {\r\n                                tooltip: {\r\n                                    trigger: 'axis',\r\n                                    axisPointer: {\r\n                                        type: 'cross',\r\n                                        crossStyle: {\r\n                                            color: '#999'\r\n                                        }\r\n                                    }\r\n                                },\r\n                                toolbox: {\r\n                                    feature: {\r\n                                        magicType: { show: true, type: ['line', 'bar'] },\r\n                                        saveAsImage: { show: true }\r\n                                    }\r\n                                },\r\n                                legend: {\r\n                                    data: data.data.legend\r\n                                },\r\n                                xAxis: [\r\n                                    {\r\n                                        type: 'category',\r\n                                        axisLabel:{interval: 0},\r\n                                        name: xAxisName,\r\n                                        data: data.data.xAxis,\r\n                                        axisPointer: {\r\n                                            type: 'shadow'\r\n                                        }\r\n                                    }\r\n                                ],\r\n                                yAxis: [\r\n                                    {\r\n                                        type: 'value',\r\n                                        name: yAxisName,\r\n                                        axisLabel: {\r\n                                            formatter: '{value}'\r\n                                        }\r\n                                    }\r\n                                ],\r\n                                series:series\r\n                            };\r\n                            statistic.setOption(option,true);\r\n                            window.onresize = function () {\r\n                                statistic.resize();\r\n                            };\r\n                        }else {\r\n                            this.$message({\r\n                                message: \"报表未查询到数据\",\r\n                                type: \"success\",\r\n                                duration: 1500,\r\n                                onClose: () => {\r\n                                    this.search();\r\n                                }\r\n                            });\r\n                        }\r\n                    });\r\n                });\r\n            },\r\n            \r\n            // 样式相关方法\r\n            contentStyleChange() {\r\n                this.contentSearchStyleChange()\r\n                this.contentBtnAdAllStyleChange()\r\n                this.contentSearchBtnStyleChange()\r\n                this.contentTableBtnStyleChange()\r\n                this.contentPageStyleChange()\r\n            },\r\n            contentSearchStyleChange() {\r\n                this.$nextTick(() => {\r\n                    document.querySelectorAll('.form-content .slt .el-input__inner').forEach(el => {\r\n                        let textAlign = 'left'\r\n                        if(this.contents.inputFontPosition == 2)\r\n                            textAlign = 'center'\r\n                            if (this.contents.inputFontPosition == 3) textAlign = 'right'\r\n                                el.style.textAlign = textAlign\r\n                            el.style.height = this.contents.inputHeight\r\n                            el.style.lineHeight = this.contents.inputHeight\r\n                            el.style.color = this.contents.inputFontColor\r\n                            el.style.fontSize = this.contents.inputFontSize\r\n                            el.style.borderWidth = this.contents.inputBorderWidth\r\n                            el.style.borderStyle = this.contents.inputBorderStyle\r\n                            el.style.borderColor = this.contents.inputBorderColor\r\n                            el.style.borderRadius = this.contents.inputBorderRadius\r\n                            el.style.backgroundColor = this.contents.inputBgColor\r\n                    })\r\n                    if (this.contents.inputTitle) {\r\n                        document.querySelectorAll('.form-content .slt .el-form-item__label').forEach(el => {\r\n                            el.style.color = this.contents.inputTitleColor\r\n                            el.style.fontSize = this.contents.inputTitleSize\r\n                            el.style.lineHeight = this.contents.inputHeight\r\n                        })\r\n                    }\r\n                    setTimeout(() => {\r\n                        document.querySelectorAll('.form-content .slt .el-input__prefix').forEach(el => {\r\n                            el.style.color = this.contents.inputIconColor\r\n                            el.style.lineHeight = this.contents.inputHeight\r\n                        })\r\n                        document.querySelectorAll('.form-content .slt .el-input__suffix').forEach(el => {\r\n                            el.style.color = this.contents.inputIconColor\r\n                            el.style.lineHeight = this.contents.inputHeight\r\n                        })\r\n                        document.querySelectorAll('.form-content .slt .el-input__icon').forEach(el => {\r\n                            el.style.lineHeight = this.contents.inputHeight\r\n                        })\r\n                    }, 10 )\r\n                })\r\n            },\r\n            contentSearchBtnStyleChange() {\r\n                this.$nextTick(() => {\r\n                    document.querySelectorAll('.form-content .slt .el-button--success').forEach(el => {\r\n                        el.style.height = this.contents.searchBtnHeight\r\n                        el.style.color = this.contents.searchBtnFontColor\r\n                        el.style.fontSize = this.contents.searchBtnFontSize\r\n                        el.style.borderWidth = this.contents.searchBtnBorderWidth\r\n                        el.style.borderStyle = this.contents.searchBtnBorderStyle\r\n                        el.style.borderColor = this.contents.searchBtnBorderColor\r\n                        el.style.borderRadius = this.contents.searchBtnBorderRadius\r\n                        el.style.backgroundColor = this.contents.searchBtnBgColor\r\n                    })\r\n                })\r\n            },\r\n            contentBtnAdAllStyleChange() {\r\n                this.$nextTick(() => {\r\n                    document.querySelectorAll('.form-content .ad .el-button--success').forEach(el => {\r\n                        el.style.height = this.contents.btnAdAllHeight\r\n                        el.style.color = this.contents.btnAdAllAddFontColor\r\n                        el.style.fontSize = this.contents.btnAdAllFontSize\r\n                        el.style.borderWidth = this.contents.btnAdAllBorderWidth\r\n                        el.style.borderStyle = this.contents.btnAdAllBorderStyle\r\n                        el.style.borderColor = this.contents.btnAdAllBorderColor\r\n                        el.style.borderRadius = this.contents.btnAdAllBorderRadius\r\n                        el.style.backgroundColor = this.contents.btnAdAllAddBgColor\r\n                    })\r\n                    document.querySelectorAll('.form-content .ad .el-button--danger').forEach(el => {\r\n                        el.style.height = this.contents.btnAdAllHeight\r\n                        el.style.color = this.contents.btnAdAllDelFontColor\r\n                        el.style.fontSize = this.contents.btnAdAllFontSize\r\n                        el.style.borderWidth = this.contents.btnAdAllBorderWidth\r\n                        el.style.borderStyle = this.contents.btnAdAllBorderStyle\r\n                        el.style.borderColor = this.contents.btnAdAllBorderColor\r\n                        el.style.borderRadius = this.contents.btnAdAllBorderRadius\r\n                        el.style.backgroundColor = this.contents.btnAdAllDelBgColor\r\n                    })\r\n                    document.querySelectorAll('.form-content .ad .el-button--warning').forEach(el => {\r\n                        el.style.height = this.contents.btnAdAllHeight\r\n                        el.style.color = this.contents.btnAdAllWarnFontColor\r\n                        el.style.fontSize = this.contents.btnAdAllFontSize\r\n                        el.style.borderWidth = this.contents.btnAdAllBorderWidth\r\n                        el.style.borderStyle = this.contents.btnAdAllBorderStyle\r\n                        el.style.borderColor = this.contents.btnAdAllBorderColor\r\n                        el.style.borderRadius = this.contents.btnAdAllBorderRadius\r\n                        el.style.backgroundColor = this.contents.btnAdAllWarnBgColor\r\n                    })\r\n                })\r\n            },\r\n            rowStyle({row, rowIndex}) {\r\n                if (rowIndex % 2 == 1) {\r\n                    if (this.contents.tableStripe) {\r\n                        return {color: this.contents.tableStripeFontColor}\r\n                    }\r\n                } else {\r\n                    return ''\r\n                }\r\n            },\r\n            cellStyle({row, rowIndex}) {\r\n                if (rowIndex % 2 == 1) {\r\n                    if (this.contents.tableStripe) {\r\n                        return {backgroundColor: this.contents.tableStripeBgColor}\r\n                    }\r\n                } else {\r\n                    return ''\r\n                }\r\n            },\r\n            headerRowStyle({row, rowIndex}) {\r\n                return {color: this.contents.tableHeaderFontColor}\r\n            },\r\n            headerCellStyle({row, rowIndex}) {\r\n                return {backgroundColor: this.contents.tableHeaderBgColor}\r\n            },\r\n\r\n            contentPageStyleChange() {\r\n                let arr = []\r\n                if (this.contents.pageTotal) arr.push('total')\r\n                if (this.contents.pageSizes) arr.push('sizes')\r\n                if (this.contents.pagePrevNext) {\r\n                    arr.push('prev')\r\n                    if (this.contents.pagePager) arr.push('pager')\r\n                    arr.push('next')\r\n                }\r\n                if (this.contents.pageJumper) arr.push('jumper')\r\n                this.layouts = arr.join()\r\n                this.contents.pageEachNum = 10\r\n            },\r\n\r\n            init() {\r\n            },\r\n            search() {\r\n                this.pageIndex = 1;\r\n                this.getDataList();\r\n            },\r\n            // 获取数据列表\r\n            getDataList() {\r\n                this.dataListLoading = true;\r\n                let params = {\r\n                    page: this.pageIndex,\r\n                    limit: this.pageSize,\r\n                    sort: 'id',\r\n                }\r\n\r\n                if (this.searchForm.bisaixiangmuName!= '' && this.searchForm.bisaixiangmuName!= undefined) {\r\n                    params['bisaixiangmuName'] = '%' + this.searchForm.bisaixiangmuName + '%'\r\n                }\r\n                \r\n                if (this.searchForm.bisaixiangmuTypes!= '' && this.searchForm.bisaixiangmuTypes!= undefined) {\r\n                    params['bisaixiangmuTypes'] = this.searchForm.bisaixiangmuTypes\r\n                }\r\n                \r\n                if (this.searchForm.yonghuName!= '' && this.searchForm.yonghuName!= undefined) {\r\n                    params['yonghuName'] = '%' + this.searchForm.yonghuName + '%'\r\n                }\r\n                \r\n                if (this.searchForm.zhuangtaiTypes!= '' && this.searchForm.zhuangtaiTypes!= undefined) {\r\n                    params['zhuangtaiTypes'] = this.searchForm.zhuangtaiTypes\r\n                }\r\n                \r\n                if (this.searchForm.siachenganpaiTypes!= '' && this.searchForm.siachenganpaiTypes!= undefined) {\r\n                    params['siachenganpaiTypes'] = this.searchForm.siachenganpaiTypes\r\n                }\r\n                \r\n                params['siachenganpaiDelete'] = 1// 逻辑删除字段 1 未删除 2 删除\r\n\r\n                this.$http({\r\n                    url: \"siachenganpai/page\",\r\n                    method: \"get\",\r\n                    params: params\r\n                }).then(({data}) => {\r\n                    if(data && data.code === 0){\r\n                        this.dataList = data.data.list;\r\n                        this.totalPage = data.data.total;\r\n                    }else{\r\n                        this.dataList = [];\r\n                        this.totalPage = 0;\r\n                    }\r\n                    this.dataListLoading = false;\r\n                });\r\n\r\n                // 查询级联表搜索条件所有列表\r\n                this.$http({\r\n                    url: \"dictionary/page?dicCode=bisaixiangmu_types&page=1&limit=100\",\r\n                    method: \"get\",\r\n                    page: 1,\r\n                    limit: 100,\r\n                }).then(({data}) => {\r\n                    if(data && data.code === 0){\r\n                        this.bisaixiangmuTypesSelectSearch = data.data.list;\r\n                    }\r\n                });\r\n\r\n                this.$http({\r\n                    url: \"dictionary/page?dicCode=zhuangtai_types&page=1&limit=100\",\r\n                    method: \"get\",\r\n                    page: 1,\r\n                    limit: 100,\r\n                }).then(({data}) => {\r\n                    if(data && data.code === 0){\r\n                        this.zhuangtaiTypesSelectSearch = data.data.list;\r\n                    }\r\n                });\r\n\r\n                this.$http({\r\n                    url: \"dictionary/page?dicCode=siachenganpai_types&page=1&limit=100\",\r\n                    method: \"get\",\r\n                    page: 1,\r\n                    limit: 100,\r\n                }).then(({data}) => {\r\n                    if(data && data.code === 0){\r\n                        this.siachenganpaiTypesSelectSearch = data.data.list;\r\n                    }\r\n                });\r\n            },\r\n            sizeChangeHandle(val) {\r\n                this.pageSize = val;\r\n                this.getDataList();\r\n            },\r\n            currentChangeHandle(val) {\r\n                this.pageIndex = val;\r\n                this.getDataList();\r\n            },\r\n            selectionChangeHandler(selections) {\r\n                this.dataListSelections = selections;\r\n            },\r\n            addOrUpdateHandler(id, type = 'edit') {\r\n                this.addOrUpdateFlag = true;\r\n                this.$nextTick(() => {\r\n                    this.$refs.addOrUpdate.init(id, type);\r\n                });\r\n            },\r\n            deleteHandler(id) {\r\n                let _this = this;\r\n                let ids = [];\r\n                if (id) {\r\n                    ids.push(id);\r\n                } else {\r\n                    if (this.dataListSelections.length <= 0) {\r\n                        this.$message({\r\n                            message: \"请选择要删除的数据\",\r\n                            type: \"warning\"\r\n                        });\r\n                        return;\r\n                    }\r\n                    for (let i = 0; i < this.dataListSelections.length; i++) {\r\n                        ids.push(this.dataListSelections[i].id);\r\n                    }\r\n                }\r\n                this.$confirm(\"确定要删除选中的数据吗？\", \"提示\", {\r\n                    confirmButtonText: \"确定\",\r\n                    cancelButtonText: \"取消\",\r\n                    type: \"warning\"\r\n                }).then(() => {\r\n                    this.$http({\r\n                        url: \"siachenganpai/delete\",\r\n                        method: \"post\",\r\n                        data: ids\r\n                    }).then(({data}) => {\r\n                        if(data && data.code === 0){\r\n                            this.$message({\r\n                                message: \"删除成功\",\r\n                                type: \"success\"\r\n                            });\r\n                            this.search();\r\n                        }else{\r\n                            this.$message({\r\n                                message: data.message || \"删除失败\",\r\n                                type: \"error\"\r\n                            });\r\n                        }\r\n                    });\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        message: \"已取消删除\",\r\n                        type: \"info\"\r\n                    });\r\n                });\r\n            },\r\n            jieshubisai(id) {\r\n                let _this = this;\r\n                this.$confirm(\"确定要结束此比赛吗？\", \"提示\", {\r\n                    confirmButtonText: \"确定\",\r\n                    cancelButtonText: \"取消\",\r\n                    type: \"warning\"\r\n                }).then(() => {\r\n                    this.$http({\r\n                        url: \"siachenganpai/jieshubisai/\" + id,\r\n                        method: \"get\",\r\n                    }).then(({data}) => {\r\n                        if(data && data.code === 0){\r\n                            this.$message({\r\n                                message: \"操作成功\",\r\n                                type: \"success\"\r\n                            });\r\n                            this.search();\r\n                        }else{\r\n                            this.$message({\r\n                                message: data.message || \"操作失败\",\r\n                                type: \"error\"\r\n                            });\r\n                        }\r\n                    });\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        message: \"已取消操作\",\r\n                        type: \"info\"\r\n                    });\r\n                });\r\n            },\r\n            dayinOpen(row) {\r\n                this.printFrom = row;\r\n                this.printVisiable = true;\r\n            },\r\n            printContent() {\r\n                window.print();\r\n            },\r\n            wuyong(id) {\r\n                this.$message({\r\n                    message: \"这是一个无用按钮，仅用于测试\",\r\n                    type: \"info\"\r\n                });\r\n            },\r\n            siachenganpaiUploadSuccess(res, file) {\r\n                if (res.code === 0) {\r\n                    this.$message({\r\n                        message: \"导入成功\",\r\n                        type: \"success\"\r\n                    });\r\n                    this.search();\r\n                } else {\r\n                    this.$message({\r\n                        message: res.message || \"导入失败\",\r\n                        type: \"error\"\r\n                    });\r\n                }\r\n            },\r\n            siachenganpaiUploadError(err) {\r\n                this.$message({\r\n                    message: \"导入失败\",\r\n                    type: \"error\"\r\n                });\r\n            }\r\n        }\r\n    };\r\n</script>\r\n<style scoped>\r\n    .main-content {\r\n        padding: 10px;\r\n    }\r\n    .form-content {\r\n        background-color: #fff;\r\n        padding: 10px;\r\n        margin-bottom: 10px;\r\n    }\r\n    .table-content {\r\n        background-color: #fff;\r\n        padding: 10px;\r\n    }\r\n    .pagination-content {\r\n        margin-top: 10px;\r\n    }\r\n</style>    "]}]}